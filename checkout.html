<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TD5BTHNQ');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex,nofollow">
    <meta name="description" content="Secure checkout at Puppiary.">
    <title>Checkout - Puppiary</title>
    <!-- Preconnect to critical origins -->
    <link rel="preconnect" href="https://fonts.cdnfonts.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.cdnfonts.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <!-- Load fonts with link tag for better performance (replaces @import) - non-blocking -->
    <link rel="stylesheet" href="https://fonts.cdnfonts.com/css/futura-pt" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://fonts.cdnfonts.com/css/futura-pt"></noscript>
    <!-- Preload critical resources -->
    <link rel="preload" href="/css/style.css" as="style">
    <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
    <link rel="shortcut icon" href="/favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Puppiary" />
    <link rel="manifest" href="/favicon/site.webmanifest" />
    <link rel="stylesheet" href="/css/style.css">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: https: https://www.gstatic.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com https://www.gstatic.com https://tagassistant.google.com https://www.google-analytics.com https://ssl.google-analytics.com https://www.googletagservices.com https://connect.facebook.net https://cdn.jsdelivr.net https://js.paystack.co; style-src 'self' 'unsafe-inline' https://fonts.cdnfonts.com https://fonts.googleapis.com https://www.googletagmanager.com https://paystack.com; font-src 'self' https://fonts.cdnfonts.com https://fonts.gstatic.com data:; connect-src 'self' https://www.googletagmanager.com https://googletagmanager.com https://tagassistant.google.com wss://tagassistant.google.com https://www.google-analytics.com https://ssl.google-analytics.com https://region1.google-analytics.com https://region2.google-analytics.com https://region3.google-analytics.com https://region4.google-analytics.com https://region5.google-analytics.com https://stats.g.doubleclick.net https://connect.facebook.net https://www.facebook.com; frame-src https://www.googletagmanager.com https://tagassistant.google.com https://js.paystack.co https://checkout.paystack.com https://www.google-analytics.com; upgrade-insecure-requests;">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <link rel="canonical" href="https://www.puppiary.com/checkout">
    <script src="/js/seo.js" defer></script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TD5BTHNQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <header class="navbar">
        <div class="navbar-container">
            <a href="/" class="navbar-logo">
                <img src="/logo.webp" alt="" class="logo-image" width="50" height="50">
                Puppiary
            </a>
            <nav class="navbar-menu" aria-label="Primary">
                <a href="/products" class="nav-link">Shop</a>
                <a href="/about" class="nav-link">About</a>
                <a href="/faq" class="nav-link">FAQ</a>
                <a href="/contact" class="nav-link">Contact</a>
            </nav>
            <button class="mobile-menu-button" aria-label="Open menu" aria-controls="mobile-drawer" aria-expanded="false">
                <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"/>
                </svg>
            </button>
            <a href="/cart" class="cart-icon">
                <span class="cart-icon-text">ðŸ›’</span>
                <span class="cart-counter" aria-label="Items in cart">0</span>
            </a>
        </div>
    </header>

    <div class="drawer-overlay" data-overlay hidden></div>
    <aside id="mobile-drawer" class="mobile-drawer" aria-hidden="true" aria-label="Mobile navigation">
        <div class="mobile-drawer-header">
            <span class="drawer-title">Menu</span>
            <button class="drawer-close" aria-label="Close menu">
                <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M18.3 5.71 12 12l6.3 6.29-1.41 1.41L10.59 13.4 4.29 19.7 2.88 18.3 9.17 12 2.88 5.71 4.29 4.3l6.3 6.3 6.29-6.3z"/>
                </svg>
            </button>
        </div>
        <nav class="mobile-drawer-nav" aria-label="Mobile Primary">
            <a href="/products" class="drawer-link">Shop</a>
            <a href="/about" class="drawer-link">About</a>
            <a href="/faq" class="drawer-link">FAQ</a>
            <a href="/contact" class="drawer-link">Contact</a>
        </nav>
    </aside>
    <main>
        <section class="checkout-section">
            <h1>Checkout</h1>

			<div class="checkout-container">
				<form id="checkout-form" class="checkout-form">
                    <fieldset>
                        <legend>Shipping Information</legend>
                        
                        <div class="form-group">
                            <label for="fullname">Full Name *</label>
                            <input type="text" id="fullname" name="fullname" required>
                        </div>

                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" id="email" name="email" required>
                        </div>

                        <div class="form-group">
                            <label for="phone">Phone Number *</label>
                            <input type="tel" id="phone" name="phone" required>
                        </div>

                        <div class="form-group">
                            <label for="address1">Address *</label>
                            <input type="text" id="address1" name="address1" required>
                        </div>

                        <div class="form-group">
                            <label for="state">State *</label>
                            <select id="state" name="state" required>
                                <option value="">Select State</option>
                                <option value="Abia">Abia</option>
                                <option value="Adamawa">Adamawa</option>
                                <option value="Akwa Ibom">Akwa Ibom</option>
                                <option value="Anambra">Anambra</option>
                                <option value="Bauchi">Bauchi</option>
                                <option value="Bayelsa">Bayelsa</option>
                                <option value="Benue">Benue</option>
                                <option value="Borno">Borno</option>
                                <option value="Cross River">Cross River</option>
                                <option value="Delta">Delta</option>
                                <option value="Ebonyi">Ebonyi</option>
                                <option value="Edo">Edo</option>
                                <option value="Ekiti">Ekiti</option>
                                <option value="Enugu">Enugu</option>
                                <option value="FCT">Federal Capital Territory</option>
                                <option value="Gombe">Gombe</option>
                                <option value="Imo">Imo</option>
                                <option value="Jigawa">Jigawa</option>
                                <option value="Kaduna">Kaduna</option>
                                <option value="Kano">Kano</option>
                                <option value="Katsina">Katsina</option>
                                <option value="Kebbi">Kebbi</option>
                                <option value="Kogi">Kogi</option>
                                <option value="Kwara">Kwara</option>
                                <option value="Lagos">Lagos</option>
                                <option value="Nasarawa">Nasarawa</option>
                                <option value="Niger">Niger</option>
                                <option value="Ogun">Ogun</option>
                                <option value="Ondo">Ondo</option>
                                <option value="Osun">Osun</option>
                                <option value="Oyo">Oyo</option>
                                <option value="Plateau">Plateau</option>
                                <option value="Rivers">Rivers</option>
                                <option value="Sokoto">Sokoto</option>
                                <option value="Taraba">Taraba</option>
                                <option value="Yobe">Yobe</option>
                                <option value="Zamfara">Zamfara</option>
                            </select>
                        </div>

                        <input type="hidden" id="country" name="country" value="Nigeria">
                    </fieldset>

					<!-- Paystack is the only supported payment method. -->

                    <div class="accepted-payment-methods">
                        <p class="payment-methods-label">We Accept:</p>
                        <div class="payment-methods-grid">
                            <div class="payment-method-item" title="Bank Transfer">
                                <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
                                    <path fill="#0066CC" d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                                </svg>
                                <span>Bank Transfer</span>
                            </div>
                            <div class="payment-method-item" title="Verve">
                                <div class="payment-icon verve">VERVE</div>
                                <span>Verve</span>
                            </div>
                            <div class="payment-method-item" title="USSD">
                                <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
                                    <path fill="#00A859" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                </svg>
                                <span>USSD</span>
                            </div>
                            <div class="payment-method-item" title="OPay">
                                <img src="/opay.png" alt="OPay" class="payment-logo opay-logo">
                                <span>OPay</span>
                            </div>
                            <div class="payment-method-item" title="Visa">
                                <div class="payment-icon visa">VISA</div>
                                <span>Visa</span>
                            </div>
                            <div class="payment-method-item" title="Mastercard">
                                <div class="payment-icon mastercard">
                                    <div class="mc-circle mc-red"></div>
                                    <div class="mc-circle mc-orange"></div>
                                </div>
                                <span>Mastercard</span>
                            </div>
                            </div>
                        </div>

                    <div class="checkout-trust-badges">
                        <div class="trust-item">
                            <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
                                <path fill="currentColor" d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 6h2v6h-2V7zm0 8h2v2h-2v-2z"/>
                            </svg>
                            <span>Secure Payment</span>
                        </div>
                        <div class="trust-item">
                            <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
                                <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            <span>SSL Encrypted</span>
                        </div>
                        <div class="trust-item">
                            <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
                                <path fill="currentColor" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                            <span>Money-Back Guarantee</span>
                        </div>
                    </div>

                    <div class="checkout-actions">
                        <button type="submit" class="btn btn-primary btn-large">Complete Order</button>
                        <a href="/products" class="btn btn-secondary btn-large">Continue Shopping</a>
                    </div>

                    <div class="checkout-guarantees">
                        <p class="guarantee-text">
                            <strong>âœ“ 30-Day Money-Back Guarantee</strong><br>
                            Not satisfied? Get a full refund, no questions asked.
                        </p>
                        <p class="guarantee-text">
                            <strong>âœ“ Free Returns</strong><br>
                            Easy returns within 30 days of delivery.
                        </p>
                        <p class="guarantee-text">
                            <strong>âœ“ Secure Checkout</strong><br>
                            Your payment information is encrypted and secure.
                        </p>
                    </div>
                </form>
				<aside class="checkout-summary" aria-label="Order Summary">
					<h3>Order Summary</h3>
					<div id="order-items">
						<!-- Populated by JS -->
					</div>
					<div class="summary-row" style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-top: 1px solid #eee;">
						<span>Delivery Fee:</span>
						<span id="delivery-fee">â‚¦0.00</span>
					</div>
					<div class="summary-total">
						<strong>Total: â‚¦<span id="total-price">0.00</span></strong>
					</div>
					
					<div class="checkout-social-proof">
						<div class="social-proof-item">
							<div class="proof-stars">â˜…â˜…â˜…â˜…â˜…</div>
							<p class="proof-text"><strong>4.8/5</strong> from 2,500+ happy customers</p>
						</div>
						<div class="social-proof-item">
							<svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
								<path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
							</svg>
							<span>Trusted by 10,000+ customers</span>
						</div>
						<div class="social-proof-item">
							<svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
								<path fill="currentColor" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
							</svg>
							<span>Fast &amp; Reliable Delivery</span>
						</div>
					</div>

					<div class="payment-security">
						<p class="security-label">Secured by:</p>
						<div class="security-badges">
							<div class="security-badge">
								<svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
									<path fill="currentColor" d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 6h2v6h-2V7zm0 8h2v2h-2v-2z"/>
								</svg>
								<span>Paystack</span>
							</div>
							<div class="security-badge">
								<svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
									<path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
								</svg>
								<span>SSL Secure</span>
							</div>
						</div>
					</div>
				</aside>
            </div>
        </section>

    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <p>&copy; 2025 Puppiary. All rights reserved.</p>
            </div>
            <nav class="footer-section" aria-label="Footer">
                <a href="/privacy">Privacy Policy</a>
                <a href="/terms">Terms & Conditions</a>
                <a href="/refund">Return & Refund Policy</a>
            </nav>
            <div class="footer-section">
                <p>Follow us:</p>
                <div class="social-links">
                    <a href="https://www.instagram.com/puppiaryhq" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="Instagram" title="Instagram: @puppiaryhq.ng">
                        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm5 5a5 5 0 100 10 5 5 0 000-10zm6-1a1 1 0 110 2 1 1 0 010-2z" fill="currentColor"/></svg>
                    </a>
                    <a href="https://www.tiktok.com/@puppiaryhqhq" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="TikTok" title="TikTok: @puppiaryhq">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="currentColor" d="M13 2h3.2c.3 1.2 1 2.4 2 3.2A6.9 6.9 0 0021 6.5V9c-1.8 0-3.5-.5-5-1.4v6.2A6.8 6.8 0 019.2 21 6.7 6.7 0 013 14.3 6.7 6.7 0 019.7 7.6c.4 0 .9 0 1.3.1V11a3.8 3.8 0 00-1.3-.2A3.3 3.3 0 006.4 14.2a3.3 3.3 0 003.3 3.3c1.8 0 3.3-1.5 3.3-3.3V2z"/>
                        </svg>
                    </a>
                    <a href="https://twitter.com/puppiaryhq" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="Twitter" title="Twitter: @puppiaryhq">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="currentColor" d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </a>
                    <a href="https://www.facebook.com/puppiaryhq" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="Facebook" title="Facebook: @puppiaryhq">
                        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M22 12c0-5.522-4.477-10-10-10S2 6.478 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.988H7.898v-2.89h2.54V9.797c0-2.507 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.261c-1.243 0-1.631.771-1.631 1.562v1.875h2.773l-.443 2.89h-2.33V21.88C18.343 21.128 22 16.991 22 12z" fill="currentColor"/></svg>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-payment-section">
            <div class="footer-payment-container">
                <p class="footer-payment-label">Accepted Payment Methods:</p>
                <div class="footer-payment-grid">
                    <div class="footer-payment-item footer-payment-left" title="Bank Transfer">
                        <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
                            <path fill="currentColor" d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                        <span>Bank Transfer</span>
                    </div>
                    <div class="footer-payment-item" title="Verve">
                        <div class="footer-payment-icon verve">VERVE</div>
                    </div>
                    <div class="footer-payment-item footer-payment-left" title="USSD">
                        <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
                            <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <span>USSD</span>
                    </div>
                    <div class="footer-payment-item" title="OPay">
                        <img src="/opay.png" alt="OPay" class="footer-payment-logo opay-logo-footer">
                    </div>
                    <div class="footer-payment-item" title="Visa">
                        <div class="footer-payment-icon visa">VISA</div>
                    </div>
                    <div class="footer-payment-item" title="Mastercard">
                        <div class="footer-payment-icon mastercard">
                            <div class="footer-mc-circle footer-mc-red"></div>
                            <div class="footer-mc-circle footer-mc-orange"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-secured-section">
            <div class="footer-secured-container">
                <p class="footer-secured-label">Secured by:</p>
                <div class="footer-secured-badges">
                    <div class="footer-secured-item">
                        <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
                            <path fill="currentColor" d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 6h2v6h-2V7zm0 8h2v2h-2v-2z"/>
                        </svg>
                        <span>Paystack</span>
                    </div>
                    <div class="footer-secured-item">
                        <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
                            <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <span>SSL Secure</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

	<script src="/js/main.js"></script>
	<script src="/js/products.js"></script>
	<script src="/js/cart.js"></script>
	<script src="https://js.paystack.co/v1/inline.js"></script>
    <script>
		// Configure your Paystack public key (Test or Live)
		// Old test key (commented out):
		// const PAYSTACK_PUBLIC_KEY = 'pk_test_132e17cd46e7aed3802ce0b41d51a1ceb61d1efc'
		// Live key:
		const PAYSTACK_PUBLIC_KEY = 'pk_live_b502bc43c6a41a29f804bacde50cf34f9b35502a'

        document.addEventListener('DOMContentLoaded', function() {
            const cart = getCart();
            const orderItems = document.getElementById('order-items');
            let total = 0;

            cart.forEach(item => {
                const product = products.find(p => p.id === item.id);
                if (product) {
                    const itemTotal = product.price * item.quantity;
                    total += itemTotal;
                    orderItems.innerHTML += `
                        <div class="order-item">
                            <span>${product.name} x ${item.quantity}</span>
                            <span>â‚¦${formatPrice(itemTotal)}</span>
                        </div>
                    `;
                }
            });

            const deliveryFee = DELIVERY_FEE
            const grandTotal = total + deliveryFee

            document.getElementById('delivery-fee').textContent = `â‚¦${formatPrice(deliveryFee)}`
            document.getElementById('total-price').textContent = formatPrice(grandTotal);

            const checkoutForm = document.getElementById('checkout-form');
            if (!checkoutForm) {
                console.error('Checkout form not found');
                return;
            }

            checkoutForm.addEventListener('submit', function(e) {
                e.preventDefault();
				const form = this;
				console.log('Form submitted');

				// Ensure cart has items
				if (!cart || cart.length === 0) {
					alert('Your cart is empty.');
					return;
				}

				// Calculate grand total with delivery fee
				const deliveryFee = DELIVERY_FEE
				const grandTotal = total + deliveryFee

				// Check if total is valid
				if (grandTotal <= 0) {
					alert('Invalid order total. Please check your cart.');
					return;
				}

				// Check if Paystack is loaded
				if (typeof PaystackPop === 'undefined') {
					alert('Payment system is loading. Please wait a moment and try again.');
					return;
				}

				// Collect required customer data
				const email = document.getElementById('email').value.trim();
				const fullname = document.getElementById('fullname').value.trim();
				const phone = document.getElementById('phone').value.trim();
				const address1 = document.getElementById('address1').value.trim();
				const state = document.getElementById('state').value;
				const country = document.getElementById('country').value;

				// Validate all required fields
				if (!email || !fullname || !phone || !address1 || !state) {
					alert('Please fill in all required fields: Name, Email, Phone, Address, and State.');
					return;
				}

				// Validate email format
				const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
				if (!emailRegex.test(email)) {
					alert('Please enter a valid email address.');
					return;
				}

				const [firstName, ...restParts] = fullname.trim().split(' ');
				const lastName = restParts.join(' ') || '';
				const orderSummary = cart.map(item => {
					const product = products.find(p => p.id === item.id);
					if (!product) return `Item ${item.id} x ${item.quantity}`;
					const itemTotal = product.price * item.quantity;
					return `${product.name} x ${item.quantity} = â‚¦${formatPrice(itemTotal)}`;
				}).join('; ');
				const addressLine = [address1, state, country].filter(Boolean).join(', ');

				// Initialize Paystack popup
				try {
				const handler = PaystackPop.setup({
					key: PAYSTACK_PUBLIC_KEY,
					email: email,
					amount: Math.round(grandTotal * 100), // amount in kobo
					currency: 'NGN',
					ref: 'PUPPIARY_' + Date.now(),
					metadata: {
						fullname: fullname,
						firstname: firstName,
						lastname: lastName,
						phone: phone,
						email: email,
						address: {
							address1: address1,
							state: state,
							country: country
						},
						cart: cart.map(i => {
							const product = products.find(p => p.id === i.id);
							return {
								id: i.id,
								name: product ? product.name : `Item ${i.id}`,
								price: product ? product.price : undefined,
								quantity: i.quantity,
								line_total: product ? +(product.price * i.quantity).toFixed(2) : undefined
							};
						}),
						subtotal: +total.toFixed(2),
						delivery_fee: +deliveryFee.toFixed(2),
						total: +grandTotal.toFixed(2),
						custom_fields: [
							{
								display_name: 'Customer Name',
								variable_name: 'customer_name',
								value: fullname
							},
							{
								display_name: 'Phone',
								variable_name: 'phone',
								value: phone
							},
							{
								display_name: 'Address',
								variable_name: 'address',
								value: addressLine
							},
							{
								display_name: 'Order Items',
								variable_name: 'order_items',
								value: orderSummary
							},
							{
								display_name: 'Order Total (NGN)',
								variable_name: 'order_total',
								value: `â‚¦${formatPrice(grandTotal)}`
							}
						]
					},
					callback: function(response) {
						// Payment successful: clear cart and redirect to success page with reference
						try {
							clearCart();
							updateCartCounter();
						} catch (e) {}
						window.location.href = `/success?ref=${encodeURIComponent(response.reference)}`;
					},
					onClose: function() {
						// User closed payment window
					}
				});
				handler.openIframe();
				} catch (error) {
					console.error('Paystack setup error:', error);
					alert('An error occurred while setting up payment. Please try again.');
				}
            });
        });
    </script>

    <!-- Floating Call Button -->
    <a href="tel:+2347016426458" class="call-float" aria-label="Call us" title="Call us">
        <svg viewBox="0 0 24 24" width="28" height="28" aria-hidden="true">
            <path fill="currentColor" d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
        </svg>
    </a>

    <!-- Floating WhatsApp Button -->
    <a href="https://wa.me/2347016426458" target="_blank" rel="noopener noreferrer" class="whatsapp-float" aria-label="Chat with us on WhatsApp" title="Chat with us on WhatsApp">
        <svg viewBox="0 0 24 24" width="28" height="28" aria-hidden="true">
            <path fill="currentColor" d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
        </svg>
    </a>
</body>
</html>
